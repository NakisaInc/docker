
  hanelly:
    image: <NAK_IMAGE_HANELLY>
    depends_on:
      - hanelly-db
      - elasticsearch
      <NAK_HANELLY_DEPENDENCIES>
    volumes:
        - /nakisa/app-volumes/prometheus-agent:/usr/local/tomcat/agent/
        - /nakisa/app-volumes/idocs-data:/nakisa/idocs
        - /nakisa/app-volumes/tomcat-logs:/usr/local/tomcat/logs
        # the following volume is mapped to a named volume because it contains subdirectories and data which we don't want to overwrite
        - hanelly-data:/usr/local/tomcat/webapps/hanelly
        - tomcat-conf:/usr/local/tomcat/conf
    ports:
        - "80:8080"
    environment:
        JAVA_OPTS: "-Dfile.encoding='UTF-8'"
        CATALINA_OPTS: "-javaagent:/usr/local/tomcat/agent/jmx_prometheus_javaagent-0.8.jar=4000:/usr/local/tomcat/agent/tomcat.yml -Dredis.host=redis -Ddynamic.embedded=false -Ddynamic.host=elasticsearch -Ddynamic.cluster=elasticsearch -Dcluster.standalone=false -Dcluster.discovery.file=WEB-INF/tcp.xml -Djgroups.bind_addr=hanelly -Djava.net.preferIPv4Stack=true -Dnak.authentication.token=<NAK_INTERNAL_AUTHENTICATION_TOKEN> -Dnak.volume.path.idoc=/nakisa/idocs -Dnak.idoc.app.url=http://idoclistener:10002/idoc-listener -Dnak.queue.url=http://taskmanager:10000/queue-manager -Dnak.backup.app.url=http://backupmanager:10001/backup-manager -Dnak.volume.path.backup=/nakisa/backup -Dfile.encoding='UTF-8' -Xms<NAK_MEMORY_MIN_HANELLY> -Xmx<NAK_MEMORY_MAX_HANELLY>"
